BX.namespace("BX.Catalog.Admin");BX.Catalog.Admin.IblockChangePrice=function(){var e={selectEl:{},inputEl:{},checkboxEl:{},spanEl:{},radioEl:{},labelEl:{}};var l=null;var t={onePriceType:"",nullValue:""};return{init:function(a){e.selectEl.changing=document.getElementById("tableActionChangingSelect");e.selectEl.unit=document.getElementById("tableUnitsSelect");e.selectEl.priceTypeInitial=document.getElementById("tablePriceTypeIdSelect");e.selectEl.resultMask=document.getElementById("resultMaskSelect");e.selectEl.priceType=document.getElementById("initialPriceTypeSelect");e.spanEl.resultValue=document.getElementById("resultValueSpan");e.inputEl.example=document.getElementById("exampleSourceValueInput");e.inputEl.difference=document.getElementById("differenceValueInput");e.inputEl.valuePrice=document.getElementById("tableValueChangingPriceInput");e.labelEl.priceType=document.getElementById("initialPriceTypeLabel");e.labelEl.difference=document.getElementById("differenceValueLabel");e.labelEl.resultMask=document.getElementById("resultMaskLabel");e.radioEl.radioButtons=document.getElementsByName("formatResultRadio");e.checkboxEl.priceType=document.getElementById("initialPriceTypeCheckbox");e.checkboxEl.difference=document.getElementById("differenceValueCheckbox");e.checkboxEl.resultMask=document.getElementById("resultMaskCheckbox");l=a.tableReloadId||null;t=a.alertMessages||"";BX.bind(e.inputEl.valuePrice,"input",BX.delegate(function(e){this.inputDigitalMask(e.target)},this));BX.bind(e.inputEl.difference,"input",BX.delegate(function(e){this.reloadExample();this.inputDigitalMask(e.target)},this));BX.bind(e.inputEl.example,"input",BX.delegate(function(e){this.reloadExample();this.inputDigitalMask(e.target)},this));BX.bind(e.checkboxEl.difference,"change",BX.delegate(function(){this.reloadExample();this.showHideInitialElement(e.checkboxEl.difference,e.labelEl.difference,e.inputEl.difference)},this));BX.bind(e.checkboxEl.resultMask,"change",BX.delegate(function(){this.reloadExample();this.showHideInitialElement(e.checkboxEl.resultMask,e.labelEl.resultMask,e.selectEl.resultMask)},this));BX.bind(e.checkboxEl.priceType,"change",BX.delegate(function(l){if(e.selectEl.priceType.length==1){l.target.checked=false;window.alert(t.onePriceType);return false}this.showHideInitialElement(e.checkboxEl.priceType,e.labelEl.priceType,e.selectEl.priceType)},this));BX.bind(e.selectEl.resultMask,"change",BX.delegate(this.reloadExample,this));BX.bindDelegate(document.getElementById("chp_radioTable"),"change",{name:"formatResultRadio"},BX.proxy(this.reloadExample,this));BX.bind(e.radioEl,"change",BX.delegate(this.reloadExample,this));BX.bind(document.getElementById("savebtn"),"click",BX.delegate(function(){if(e.inputEl.valuePrice.value!==""||e.inputEl.valuePrice.value!=0){var a=0;var i=0;var n=document.querySelector('input[name="formatResultRadio"]:checked');document.getElementsByName("chprice_format_result")[0].value=n.value;document.getElementsByName("chprice_result_mask")[0].value=e.selectEl.resultMask.options[e.selectEl.resultMask.selectedIndex].value;if(e.checkboxEl.difference.checked){a=e.inputEl.difference.value}document.getElementsByName("chprice_difference_value")[0].value=a;if(e.checkboxEl.priceType.checked){i=e.selectEl.priceType.options[e.selectEl.priceType.selectedIndex].value}document.getElementsByName("chprice_initial_price_type")[0].value=i;if(e.selectEl.changing.value==="add"){document.getElementsByName("chprice_value_changing_price")[0].value=e.inputEl.valuePrice.value}else{document.getElementsByName("chprice_value_changing_price")[0].value=-1*e.inputEl.valuePrice.value}document.getElementsByName("chprice_units")[0].value=e.selectEl.unit.options[e.selectEl.unit.selectedIndex].value;document.getElementsByName("chprice_id_price_type")[0].value=e.selectEl.priceTypeInitial.options[e.selectEl.priceTypeInitial.selectedIndex].value;document.getElementsByName("action_button")[0].value="change_price";BX.submit(top[l].FORM,"change_price");top.BX.WindowManager.Get().Close()}else{window.alert(t.nullValue)}},this));this.reloadExample();return this},showHideInitialElement:function(e,l,t){if(e.checked){l.classList.remove("inactive-element");t.disabled=false;t.classList.remove("inactive-element")}else{l.classList.add("inactive-element");t.disabled=true;t.classList.add("inactive-element")}},inputDigitalMask:function(e){e.value=e.value.replace(/[^\d,.]*/g,"").replace(/\,/g,".").replace(/([,.])[,.]+/g,"$1").replace(/^[^\d]*(\d+([.,]\d{0,5})?).*$/g,"$1")},reloadExample:function(){var l=0;var t=0;var a=0;var i=e.inputEl.example;var n=e.inputEl.difference;var c=e.checkboxEl.difference;var u=e.spanEl.resultValue;var s=e.selectEl.resultMask.options[e.selectEl.resultMask.selectedIndex].value;if(!isNaN(parseFloat(i.value))){t=parseFloat(i.value)}if(c.checked&&!isNaN(parseFloat(n.value))){l=parseFloat(n.value)}switch(document.querySelector('input[name="formatResultRadio"]:checked').value){case"ceil":a=Math.ceil(t*s)/s-l;if(a<0){a=0}u.innerHTML=a;break;case"floor":a=Math.floor(t*s)/s-l;if(a<0){a=0}u.innerHTML=a;break;case"round":a=Math.round(t*s)/s-l;if(a<0){a=0}u.innerHTML=a}}}};
//# sourceMappingURL=iblock_change_price.map.js